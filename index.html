<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PolyProp — Polymarket Prop Trading</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- ========== NAV ========== -->
  <nav>
    <div class="nav-logo" onclick="showPage('home')">
      <span class="dot"></span> POLYPROP
    </div>
    <div class="nav-links">
      <a data-page="home" class="active">Home</a>
      <a data-page="challenges">Challenges</a>
      <a data-page="rules">Rules</a>
      <a data-page="leaderboard">Leaderboard</a>
      <a data-page="analytics">Analytics</a>
      <a data-page="dashboard" class="auth-only">Dashboard</a>
      <a data-page="admin" class="admin-only">Admin</a>
    </div>
    <div class="nav-right">
      <span class="nav-user" id="nav-user"></span>
      <button class="nav-cta" id="nav-auth-btn" data-page="login">Sign In</button>
      <button class="nav-cta ghost" id="nav-logout-btn" style="display:none" onclick="logout()">Logout</button>
    </div>
  </nav>

  <!-- ========== HOME ========== -->
  <div id="page-home" class="page active">
    <div class="hero">
      <div class="hero-tag">Prediction Market Prop Trading</div>
      <h1>Prove Your <span>Edge</span>.<br>Get Funded.</h1>
      <p>Trade Polymarket with our capital. Pass the evaluation, prove consistency, and scale up to a funded account with real USDC.</p>
      <div class="hero-buttons">
        <button class="btn btn-primary" data-page="challenges">View Challenges →</button>
        <button class="btn btn-ghost" data-page="rules">How It Works</button>
      </div>
    </div>

    <div class="section">
      <div class="section-tag">How It Works</div>
      <h2>Three Steps to Funded</h2>
      <div class="steps">
        <div class="step">
          <div class="step-num">01</div>
          <h3>Choose a Challenge</h3>
          <p>Pick your account size and evaluation type. One-Step for experienced traders, Two-Step for a more gradual path.</p>
        </div>
        <div class="step">
          <div class="step-num">02</div>
          <h3>Prove Consistency</h3>
          <p>Trade prediction markets. Hit the profit target while staying within drawdown limits and the consistency rule.</p>
        </div>
        <div class="step">
          <div class="step-num">03</div>
          <h3>Get Funded</h3>
          <p>Pass the evaluation and receive a funded account. Keep up to 80% of your profits with real USDC payouts.</p>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-tag">FAQ</div>
      <h2>Common Questions</h2>
      <div class="faq-container">
        <div class="faq-item">
          <div class="faq-q">What markets can I trade? <span class="arrow">+</span></div>
          <div class="faq-a">You can trade any active market on Polymarket. We track your positions through the platform's public API. Political, crypto, sports, entertainment — any market is fair game.</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">How does the consistency rule work? <span class="arrow">+</span></div>
          <div class="faq-a">No single trade can account for more than a set percentage of your total profits. This ensures you're a consistent trader, not just lucky on one big bet.</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">What happens if I fail? <span class="arrow">+</span></div>
          <div class="faq-a">If you breach the drawdown limit or time runs out without hitting the target, the evaluation ends. You can purchase a new challenge and try again at any time.</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">How do payouts work? <span class="arrow">+</span></div>
          <div class="faq-a">Funded traders keep 80% of profits. Payouts are processed in USDC on a bi-weekly basis once you hit the minimum payout threshold.</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Is this real money? <span class="arrow">+</span></div>
          <div class="faq-a">The evaluation uses simulated balance tracking. Once funded, you trade with our real capital on Polymarket. Profits and payouts are in real USDC.</div>
        </div>
      </div>
    </div>

    <footer>© 2025 PolyProp — All Rights Reserved</footer>
  </div>

  <!-- ========== CHALLENGES ========== -->
  <div id="page-challenges" class="page">
    <div class="section" style="text-align:center">
      <div class="section-tag">Challenges</div>
      <h2>Choose Your Path</h2>

      <div class="challenge-toggle">
        <button id="t1" class="active">One-Step</button>
        <button id="t2">Two-Step</button>
      </div>

      <!-- ONE-STEP -->
      <div id="s1" class="challenge-set active">
        <div class="challenge-card">
          <div class="ch-header">
            <div class="ch-size">$500</div>
            <div class="ch-label">Account Size</div>
            <div class="ch-price">$79 <span>one-time</span></div>
          </div>
          <div class="ch-body">
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">10%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Min Trades</span><span class="v">5</span></div>
            <div class="ch-row"><span class="l">Consistency Rule</span><span class="v">20%</span></div>
            <div class="ch-row"><span class="l">Time Limit</span><span class="v">30 days</span></div>
            <div class="ch-row"><span class="l">Profit Split</span><span class="v">80/20</span></div>
            <button class="ch-btn" onclick="startChallenge('1step',500)">Start Challenge →</button>
          </div>
        </div>

        <div class="challenge-card feat">
          <div class="ch-header">
            <div class="ch-size">$1,000</div>
            <div class="ch-label">Account Size</div>
            <div class="ch-price">$139 <span>one-time</span></div>
          </div>
          <div class="ch-body">
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">10%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Min Trades</span><span class="v">5</span></div>
            <div class="ch-row"><span class="l">Consistency Rule</span><span class="v">20%</span></div>
            <div class="ch-row"><span class="l">Time Limit</span><span class="v">30 days</span></div>
            <div class="ch-row"><span class="l">Profit Split</span><span class="v">80/20</span></div>
            <button class="ch-btn" onclick="startChallenge('1step',1000)">Start Challenge →</button>
          </div>
        </div>

        <div class="challenge-card">
          <div class="ch-header">
            <div class="ch-size">$2,000</div>
            <div class="ch-label">Account Size</div>
            <div class="ch-price">$199 <span>one-time</span></div>
          </div>
          <div class="ch-body">
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">10%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Min Trades</span><span class="v">5</span></div>
            <div class="ch-row"><span class="l">Consistency Rule</span><span class="v">20%</span></div>
            <div class="ch-row"><span class="l">Time Limit</span><span class="v">30 days</span></div>
            <div class="ch-row"><span class="l">Profit Split</span><span class="v">80/20</span></div>
            <button class="ch-btn" onclick="startChallenge('1step',2000)">Start Challenge →</button>
          </div>
        </div>
      </div>

      <!-- TWO-STEP -->
      <div id="s2" class="challenge-set">
        <div class="challenge-card">
          <div class="ch-header">
            <div class="ch-size">$500</div>
            <div class="ch-label">Account Size</div>
            <div class="ch-price">$59 <span>one-time</span></div>
          </div>
          <div class="ch-body">
            <div class="phase-label">Phase 1</div>
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="phase-label">Phase 2</div>
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">4%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Profit Split</span><span class="v">80/20</span></div>
            <button class="ch-btn" onclick="startChallenge('2step',500)">Start Challenge →</button>
          </div>
        </div>

        <div class="challenge-card feat">
          <div class="ch-header">
            <div class="ch-size">$1,000</div>
            <div class="ch-label">Account Size</div>
            <div class="ch-price">$119 <span>one-time</span></div>
          </div>
          <div class="ch-body">
            <div class="phase-label">Phase 1</div>
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="phase-label">Phase 2</div>
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">4%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Profit Split</span><span class="v">80/20</span></div>
            <button class="ch-btn" onclick="startChallenge('2step',1000)">Start Challenge →</button>
          </div>
        </div>

        <div class="challenge-card">
          <div class="ch-header">
            <div class="ch-size">$2,000</div>
            <div class="ch-label">Account Size</div>
            <div class="ch-price">$179 <span>one-time</span></div>
          </div>
          <div class="ch-body">
            <div class="phase-label">Phase 1</div>
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="phase-label">Phase 2</div>
            <div class="ch-row"><span class="l">Profit Target</span><span class="v">4%</span></div>
            <div class="ch-row"><span class="l">Max Drawdown</span><span class="v">6%</span></div>
            <div class="ch-row"><span class="l">Profit Split</span><span class="v">80/20</span></div>
            <button class="ch-btn" onclick="startChallenge('2step',2000)">Start Challenge →</button>
          </div>
        </div>
      </div>
    </div>
    <footer>© 2025 PolyProp — All Rights Reserved</footer>
  </div>

  <!-- ========== RULES ========== -->
  <div id="page-rules" class="page">
    <div class="section">
      <div class="section-tag">Rules</div>
      <h2>Evaluation Rules</h2>
      <div class="rules-container">
        <div class="rule-block">
          <h3><span class="n">1</span> Profit Target</h3>
          <p>You must reach the profit target percentage within the time limit. One-Step requires 10%, Two-Step requires 6% (Phase 1) then 4% (Phase 2).</p>
        </div>
        <div class="rule-block">
          <h3><span class="n">2</span> Maximum Drawdown</h3>
          <p>Your account cannot drop more than 6% from its high-water mark at any point. If it does, the evaluation is immediately failed.</p>
        </div>
        <div class="rule-block">
          <h3><span class="n">3</span> Consistency Rule</h3>
          <p>No single winning trade can account for more than the allowed percentage of your total profits. This prevents lucky one-shot traders.</p>
          <table class="rt">
            <tr><td>One-Step consistency cap</td><td>20% of total profit</td></tr>
            <tr><td>Two-Step consistency cap</td><td>50% of total profit</td></tr>
          </table>
        </div>
        <div class="rule-block">
          <h3><span class="n">4</span> Minimum Trades</h3>
          <p>You must complete the minimum number of trades before the evaluation can pass. One-Step requires 5 trades, Two-Step requires 2 per phase.</p>
        </div>
        <div class="rule-block">
          <h3><span class="n">5</span> Position Sizing</h3>
          <p>No single position can exceed 15% of your current account balance. This ensures proper risk management.</p>
        </div>
        <div class="rule-block">
          <h3><span class="n">6</span> Time Limit</h3>
          <p>Each phase has a 30-day time limit. You must hit all targets within this window or the evaluation expires.</p>
        </div>
      </div>
    </div>
    <footer>© 2025 PolyProp — All Rights Reserved</footer>
  </div>

  <!-- ========== LEADERBOARD ========== -->
  <div id="page-leaderboard" class="page">
    <div class="section">
      <div class="section-tag">Leaderboard</div>
      <h2>Funded Traders</h2>
      <div id="lb-content">
        <p style="text-align:center;color:var(--text3);font-family:var(--mono);font-size:12px">Loading...</p>
      </div>
    </div>
    <footer>© 2025 PolyProp — All Rights Reserved</footer>
  </div>

  <!-- ========== ANALYTICS ========== -->
  <div id="page-analytics" class="page">
    <div id="analytics-content">
      <!-- Rendered by analytics.js -->
    </div>
    <footer>© 2025 PolyProp — All Rights Reserved</footer>
  </div>

  <!-- ========== DASHBOARD ========== -->
  <div id="page-dashboard" class="page">
    <div id="dash-content" style="padding:20px">
      <p style="text-align:center;color:var(--text3);font-family:var(--mono);font-size:12px">Loading...</p>
    </div>
    <footer>© 2025 PolyProp — All Rights Reserved</footer>
  </div>

  <!-- ========== LOGIN ========== -->
  <div id="page-login" class="page">
    <div id="auth-login">
      <div class="auth-box">
        <h2>Sign In</h2>
        <div class="sub">Access your dashboard and evaluations</div>
        <div class="msg msg-err" id="login-err"></div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input class="form-input" id="login-email" type="email" placeholder="you@email.com">
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input class="form-input" id="login-pass" type="password" placeholder="••••••••">
        </div>
        <button class="form-btn" onclick="login()">Sign In →</button>
        <div class="auth-toggle">Don't have an account? <a onclick="toggleAuth('register')">Register</a></div>
      </div>
    </div>
    <div id="auth-register" style="display:none">
      <div class="auth-box">
        <h2>Register</h2>
        <div class="sub">Create your account to get started</div>
        <div class="msg msg-err" id="reg-err"></div>
        <div class="msg msg-ok" id="reg-ok"></div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input class="form-input" id="reg-email" type="email" placeholder="you@email.com">
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input class="form-input" id="reg-pass" type="password" placeholder="Min 6 characters">
        </div>
        <div class="form-group">
          <label class="form-label">Confirm Password</label>
          <input class="form-input" id="reg-pass2" type="password" placeholder="••••••••">
        </div>
        <div class="form-group">
          <label class="form-label">Polymarket Wallet (optional)</label>
          <input class="form-input" id="reg-wallet" type="text" placeholder="0x...">
        </div>
        <button class="form-btn" onclick="register()">Create Account →</button>
        <div class="auth-toggle">Already have an account? <a onclick="toggleAuth('login')">Sign In</a></div>
      </div>
    </div>
  </div>

  <!-- ========== ADMIN ========== -->
  <div id="page-admin" class="page">
    <div class="section">
      <div class="section-tag">Admin</div>
      <h2>Administration</h2>
      <div class="admin-tabs">
        <button class="active" onclick="showAdminTab('users')">Users</button>
        <button onclick="showAdminTab('evals')">Evaluations</button>
        <button onclick="showAdminTab('create')">Create Eval</button>
      </div>
      <div id="admin-users" class="admin-section active"></div>
      <div id="admin-evals" class="admin-section"></div>
      <div id="admin-create" class="admin-section">
        <div style="max-width:480px">
          <div class="msg msg-err" id="admin-create-err"></div>
          <div class="msg msg-ok" id="admin-create-ok"></div>
          <div class="form-group">
            <label class="form-label">User Email</label>
            <input class="form-input" id="ac-email" placeholder="user@email.com">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Type</label>
              <select class="form-select" id="ac-type">
                <option value="1-step">One-Step</option>
                <option value="2-step">Two-Step</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Size</label>
              <select class="form-select" id="ac-size">
                <option value="500">$500</option>
                <option value="1000">$1,000</option>
                <option value="2000">$2,000</option>
              </select>
            </div>
          </div>
          <button class="form-btn" onclick="adminCreateEval()">Create Evaluation →</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== MODALS ========== -->

  <!-- New Trade Modal -->
  <div class="modal-bg" id="trade-modal">
    <div class="modal">
      <button class="modal-close" onclick="closeModal('trade-modal')">✕</button>
      <h3>Open New Trade</h3>
      <div class="msg msg-err" id="trade-err"></div>
      <div class="form-group">
        <label class="form-label">Contract Name</label>
        <input class="form-input" id="tr-name" placeholder="e.g. Will Trump win 2028?">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Side</label>
          <select class="form-select" id="tr-side">
            <option value="YES">YES</option>
            <option value="NO">NO</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Entry Price (¢)</label>
          <input class="form-input" id="tr-entry" type="number" placeholder="e.g. 65" min="1" max="99">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Trade Size ($)</label>
        <input class="form-input" id="tr-size" type="number" placeholder="e.g. 50" min="1">
      </div>
      <button class="form-btn" onclick="openTrade()">Place Trade →</button>
    </div>
  </div>

  <!-- Close Trade Modal -->
  <div class="modal-bg" id="close-modal">
    <div class="modal">
      <button class="modal-close" onclick="closeModal('close-modal')">✕</button>
      <h3>Close Position</h3>
      <div class="msg msg-err" id="close-err"></div>
      <p id="close-info" style="font-family:var(--mono);font-size:12px;color:var(--text2);margin-bottom:20px"></p>
      <div class="form-group">
        <label class="form-label">Exit Price (¢)</label>
        <input class="form-input" id="cl-exit" type="number" placeholder="e.g. 78" min="1" max="99">
      </div>
      <button class="form-btn" onclick="closeTrade()">Close Trade →</button>
    </div>
  </div>

  <!-- Mock Checkout Modal -->
  <div class="modal-bg" id="mock-checkout-modal">
    <div class="modal">
      <button class="modal-close" onclick="closeModal('mock-checkout-modal')">✕</button>
      <h3>Checkout</h3>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid var(--border)">
        <span id="mc-label" style="font-family:var(--mono);font-size:14px;color:var(--text)"></span>
        <span id="mc-price" style="font-family:var(--mono);font-size:20px;font-weight:700;color:var(--accent)"></span>
      </div>
      <input type="hidden" id="mc-type">
      <input type="hidden" id="mc-size">
      <div class="msg msg-err" id="mc-err"></div>
      <div class="form-group">
        <label class="form-label">Card Number</label>
        <input class="form-input" id="mc-card" placeholder="4242 4242 4242 4242">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Expiry</label>
          <input class="form-input" id="mc-expiry" placeholder="MM/YY">
        </div>
        <div class="form-group">
          <label class="form-label">CVV</label>
          <input class="form-input" id="mc-cvv" placeholder="123">
        </div>
      </div>
      <button class="form-btn" id="mc-btn" onclick="submitMockPayment()">Pay →</button>
      <p style="font-family:var(--mono);font-size:9px;color:var(--text3);text-align:center;margin-top:12px;letter-spacing:0.5px">DEMO MODE · No real charges will be made</p>
    </div>
  </div>

  <!-- ========== SCRIPTS ========== -->
  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <!-- Analytics engine (must load BEFORE app.js since app.js calls loadAnalytics) -->
  <script src="js/analytics.js"></script>
  <!-- Main app -->
  <script src="js/app.js"></script>

</body>
</html>
